<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Place Order - Krishi Kaushal</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/order.css') }}">
</head>
<body>

<div class="order-container">
    <!-- Equipment Details -->
    <div class="equipment-box">
        <img src="{{ equipment.image_url }}" alt="Equipment Image" class="equipment-image">
        <div class="equipment-info">
            <h3>{{ equipment.name }}</h3>
            <p><strong>Price per day:</strong> ₹{{ equipment.price }}</p>
            <p><strong>Available Quantity:</strong> {{ equipment.available_quantity }}</p>
        </div>
    </div>

    <form action="{{ url_for('order.order', equipment_id=equipment.id) }}" method="POST" class="order-form">
        <!-- Quantity -->
        <div class="form-group">
            <label for="quantity">Select Quantity:</label>
            <input type="number" id="quantity" name="quantity" value="1" min="1" max="{{ equipment.available_quantity }}" required>
        </div>

        <!-- Rental Dates -->
        <div class="form-group">
            <label for="from_date">From Date:</label>
            <input type="date" id="from_date" name="from_date" required>
        </div>

        <div class="form-group">
            <label for="to_date">To Date:</label>
            <input type="date" id="to_date" name="to_date" required>
        </div>

        <!-- Order Summary -->
        <div class="total-box">
            <h4>Order Summary</h4>
            <div id="order-summary">
                <div class="summary-item"><strong>Price/Day:</strong> ₹{{ equipment.price }}</div>
                <div class="summary-item"><strong>Total Days:</strong> <span id="total-days">0</span> Days</div>
                <div class="summary-item"><strong>Quantity:</strong> <span id="selected-quantity">1</span></div>
                <div class="summary-total"><strong>Total Price:</strong> ₹<span id="total-price">0.00</span></div>
            </div>
        </div>

        <!-- Delivery Address -->
        <div class="address-box">
            <h4>Delivery Address</h4>
            <div id="address-box">
                {% if address %}
                    <p><strong>{{ address.full_name }}, {{ address.phone }}</strong></p>
                    <p>{{ address.street }}, {{ address.city }}, {{ address.state }} - {{ address.postal_code }}</p>
                    <button type="button" id="edit-address-btn" class="edit-btn">Edit Address</button>
                {% else %}
                    <button type="button" id="add-address-btn" class="add-btn">Add Address</button>
                {% endif %}
            </div>
        </div>

        <!-- Payment Options -->
        <div class="payment-options">
            <h4>Payment Method</h4>
            <div class="payment-method">
                <input type="radio" id="upi" name="payment_method" value="UPI" required>
                <label for="upi">
                    <img src="{{ url_for('static', filename='images/upi.png') }}" alt="UPI Logo">
                    UPI
                </label>
            </div>
            <div class="payment-method">
                <input type="radio" id="card" name="payment_method" value="Card">
                <label for="card">
                    <img src="{{ url_for('static', filename='images/card.png') }}" alt="Card Logo">
                    Credit/Debit Card
                </label>
            </div>
            <div class="payment-method">
                <input type="radio" id="cod" name="payment_method" value="COD">
                <label for="cod">
                    <img src="{{ url_for('static', filename='images/cod.png') }}" alt="COD Logo">
                    Cash on Delivery
                </label>
            </div>
        </div>

        <!-- Place Order Button -->
        <button type="submit" class="place-order-btn">Place Order</button>
    </form>
</div>

<!-- Address Popup -->
<div id="address-popup" class="popup">
    <div class="popup-content">
        <h4>Add/Update Address</h4>
        <form id="address-form" action="{{ url_for('order.add_address') }}" method="POST">
            <input type="hidden" name="equipment_id" value="{{ equipment.id }}">
            <input type="text" id="fullname" name="fullname" placeholder="Full Name" required>
            <input type="text" id="phone" name="phone" placeholder="Phone" required>
            <input type="text" id="street" name="street" placeholder="Street" required>
            <input type="text" id="city" name="city" placeholder="City" required>
            <input type="text" id="state" name="state" placeholder="State" required>
            <input type="text" id="postal_code" name="postal_code" placeholder="Postal Code" required>
            <div class="popup-buttons">
                <button type="submit" class="save-btn">Save Address</button>
                <button type="button" id="close-popup-btn" class="cancel-btn">Cancel</button>
            </div>
        </form>
    </div>
</div>

<script src="{{ url_for('static', filename='js/order.js') }}"></script>
</body>
</html>
